SELECT *
FROM public.suicides_india;

--Creating tables
CREATE TABLE causes (
type_c character varying(100),
type_t character varying(100)
);

SELECT *
FROM causes;

CREATE TABLE people (
gender character varying(100),
age_group character varying(50),
total integer
);

SELECT *
FROM people;

CREATE TABLE location_year (
state character varying(100),
year numeric,
id serial    
);

-- Inserting data into de tables
INSERT INTO causes
SELECT type_code, type
FROM public.suicides_india;

INSERT INTO people
SELECT gender, age_group, total
FROM public.suicides_india;

INSERT INTO location_year
SELECT state, year
FROM public.suicides_india;

-- Changing a column name..

ALTER TABLE location_year
RENAME COLUMN id TO id_1;

-- Setting not null values in a column..

ALTER TABLE location_year
ALTER COLUMN year SET NOT NULL;

-- Setting unique values constraint in a column..

ALTER TABLE location_year
ADD CONSTRAINT id_unique UNIQUE(id_1);

-- Creating a primary key column with two columns
SELECT *
FROM location_year;

-- Countig the distinct values of the 2 columns, it should be the same number of the rows number in the table. 
-- It means that the combination of the 2 columns is unique and can be use to create a Primary key.

SELECT COUNT(DISTINCT(year, id_1))
FROM location_year;

ALTER TABLE location_year
ADD COLUMN r_id VARCHAR(250);

UPDATE location_year
SET r_id = CONCAT(year, '-', id_1);

ALTER TABLE location_year
ADD CONSTRAINT pk2 PRIMARY KEY (r_id);

DROP TABLE location_year;



SELECT * 
FROM people;

ALTER TABLE people
ADD COLUMN fk_id VARCHAR(250);

UPDATE people
SET fk_id = r_id 
FROM location_year;
